{% extends "base.html" %}

{% block title %}All groups &ndash; Linker{% endblock %}

{% block body_properties %}ng-controller = "allGroupsCtrl"{% endblock %}

{% block right_box %}
    <ul class = "user-box">
        <li class = "user">{{ user.name }}</li>
        <li><a href = "">Settings</a></li>
        <li><a href = "/user/signout">Sign out</a></li>
    </ul>
{% endblock %}

{% block page_title %}<h1 class = "page-title">All groups</h1>{% endblock %}

{% block page_subtitle %}List of all the groups you're in{% endblock %}

{% block front_content %}
    <p class = "text centered">You can create a new group by clicking on the button below.</p>
{% endblock %}

{% block front_action %}
    <div class = "front-action">
        <button class = "red-button big" ng-click = "showCreate()">Create new group</button>
    </div>
{% endblock %}

{% block page_options %}
    <div class = "page-options">
        <div class = "content-wrapper options-wrapper" ng-show = "isCreateShown">
            <h3>Create a new group</h3>
            <form method = "post" action = "/groups">
                <input type = "text" name = "name" class = "long name-input" placeholder = "Group name"/>
                <textarea name = "description" class = "long" placeholder = "Description"></textarea>
                <div class = "invite-wrapper">
                    <input type = "text" name = "invited-users" class = "hidden" ng-model = "_invited"/>
                    <ul class = "invited-users">
                        <li ng-repeat = "u in invited" ng-click = "$parent.removeUser( $index )">[[ u.name ]]</li>
                    </ul>
                    <div class = "suggest-wrapper">
                        <input type = "text" name = "add-user" class = "add-user" placeholder = "Invite user"
                        autocomplete = "off" ng-model = "nameStart" ng-enter = "addUser()" ng-change = "updateAutocomplete()"/>
                        <ul class = "suggest-dropdown" ng-show = "isAutocompleteShown">
                            <li ng-repeat = "u in suggestions" >
                                <a ng-click = "$parent.autocompleteClick( $index )">
                                    [[ u.name ]] <span class = "email">[[ u.email ]]</span>
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
                <button type = "submit" class = "red-button">Create group</button>
                <button type = "submit" class = "blue-button">Cancel</button>
            </form>
        </div>
    </div>
{% endblock %}

{% block page_content %}
    <div class = "page-items">
        {% if not groups %}
            <div class = "page-item group-item">
                <div class = "content-wrapper">
                    <div class = "page-item-title">
                        <h2>No groups yet</h2>
                    </div>
                    <div class = "text">
                        If you want to create one, click on the <b>big red button</b> above.
                    </div>
                </div>
            </div>
        {% else %}
            {% for gr in groups %}
                <div class = "page-item group-item">
                    <div class = "content-wrapper">
                        <div class = "page-item-title">
                            <h2><a href = "/groups/{{ gr.id }}">{{ gr.name }}</a></h2>
                            <!-- <div class = "ticket">3 new links</div> -->
                        </div>
                        <div class = "span-list">
                            <span class = "primary">{{ gr.owner }}</span>
                            <span>
                                {% for us in gr.users %}
                                    <span class = "secondary">{{ us }}</span>
                                {% endfor %}
                            </span>
                            <span class = "tertiary links">{{ gr.links_count }} links</span>
                        </div>
                        <div class = "text">
                            {{ gr.descr }}
                        </div>
                    </div>
                </div>
            {% endfor %}

        {% endif %}
       <!--  <div class = "page-item group-item">
            <div class = "content-wrapper">
                <div class = "page-item-title">
                <h2><a href = "/groups/1">Filozofija</a></h2>
                    <div class = "ticket">3 new links</div>
                </div>
                <div class = "list">
                    <span class = "primary">Mirko Slavkovic &middot;</span><span class = "secondary"> Ivo Stipic</span>
                </div>
                <div class = "text">
                    Lorem ipsum dolor sit amet, consectetur adipisicing elit. Magnam consequuntur eum dolorum, blanditiis, aliquid cupiditate suscipit? Deserunt animi eius autem aliquid harum sapiente ex, adipisci natus, obcaecati possimus, ut saepe.
                </div>
            </div>
        </div> -->
    </div>
{% endblock %}
